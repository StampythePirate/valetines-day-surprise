<!--
Save this file as index.html
Upload it to a GitHub repository
Go to Settings ‚Üí Pages
Select Deploy from branch
Choose main branch / root
Site will be live via GitHub Pages
-->
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Valentine Surprise</title>
    <style>
      :root {
        --pink-1: #ffe6f2;
        --pink-2: #ffd1e8;
        --pink-3: #ffb3da;
        --pink-4: #ff8cc2;
        --rose: #ff6fae;
        --cream: #fff7fb;
        --ink: #5b2246;
        --shadow-soft: 0 16px 32px rgba(255, 111, 174, 0.25);
        --shadow-btn: 0 8px 16px rgba(255, 111, 174, 0.3);
        --card-radius: 28px;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(140deg, #ffd6ea 0%, #ffeef6 45%, #ffd1e8 100%);
        font-family: "Trebuchet MS", "Comic Sans MS", "Segoe UI", sans-serif;
        color: var(--ink);
        overflow: hidden;
        position: relative;
      }

      body::before {
        content: "";
        position: fixed;
        inset: 0;
        pointer-events: none;
        background-image:
          radial-gradient(circle, rgba(255, 255, 255, 0.9) 0 1px, transparent 2px),
          radial-gradient(circle, rgba(255, 200, 230, 0.7) 0 1.5px, transparent 3px),
          radial-gradient(circle, rgba(255, 255, 255, 0.6) 0 1px, transparent 2.5px);
        background-size: 28px 28px, 40px 40px, 20px 20px;
        background-position: 0 0, 16px 10px, 8px 20px;
        opacity: 0.6;
        z-index: 0;
        animation: glitterDrift 16s linear infinite;
      }

      #app {
        position: relative;
        width: min(92vw, 560px);
        min-height: 520px;
        padding: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1;
      }

      #background {
        position: absolute;
        inset: 0;
        border-radius: 36px;
        overflow: hidden;
        z-index: 0;
      }

      #background::before {
        content: "";
        position: absolute;
        inset: -20%;
        background:
          radial-gradient(circle at 15% 20%, rgba(255, 255, 255, 0.7), transparent 45%),
          radial-gradient(circle at 80% 10%, rgba(255, 220, 238, 0.7), transparent 40%),
          radial-gradient(circle at 50% 80%, rgba(255, 182, 213, 0.6), transparent 45%);
        opacity: 0.9;
      }

      #background::after {
        content: "";
        position: absolute;
        inset: 0;
        background-image:
          radial-gradient(circle, rgba(255, 255, 255, 0.9) 0 1px, transparent 2px),
          radial-gradient(circle, rgba(255, 214, 236, 0.8) 0 1.5px, transparent 3px),
          radial-gradient(circle, rgba(255, 255, 255, 0.7) 0 1px, transparent 2.5px);
        background-size: 24px 24px, 36px 36px, 18px 18px;
        background-position: 0 0, 10px 12px, 5px 18px;
        opacity: 0.7;
        animation: shimmer 8s linear infinite;
      }

      #float-layer,
      #sparkle-layer,
      #ladybug-layer {
        position: absolute;
        inset: 0;
      }

      #card-shell {
        position: relative;
        width: 100%;
        min-height: 440px;
        z-index: 2;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .card {
        position: absolute;
        inset: 0;
        margin: auto;
        padding: 32px 28px;
        width: 100%;
        max-width: 520px;
        background: linear-gradient(180deg, #fff6fb 0%, #ffeaf6 100%);
        border-radius: var(--card-radius);
        border: 2px solid #ffb5d8;
        box-shadow: var(--shadow-soft);
        text-align: center;
        opacity: 0;
        transform: translateY(18px) scale(0.98);
        transition: opacity 0.35s ease, transform 0.35s ease;
        pointer-events: none;
      }

      .card.is-active {
        opacity: 1;
        transform: translateY(0) scale(1);
        pointer-events: auto;
      }

      .card-title {
        font-size: 2.2rem;
        margin-bottom: 8px;
      }

      h1,
      h2 {
        font-family: "Comic Sans MS", "Trebuchet MS", cursive;
        color: #c12b6b;
        margin: 12px 0 18px;
        line-height: 1.2;
      }

      p {
        margin: 12px 0 20px;
        font-size: 1.05rem;
      }

      .tiny-note {
        font-size: 0.9rem;
        opacity: 0.75;
        margin-top: 14px;
      }

      .button-row {
        display: flex;
        gap: 14px;
        justify-content: center;
        flex-wrap: wrap;
      }

      .btn {
        position: relative;
        border: none;
        border-radius: 999px;
        padding: 12px 22px;
        font-size: 1rem;
        font-weight: 700;
        cursor: pointer;
        box-shadow: var(--shadow-btn);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        --btn-x: 0px;
        --btn-y: 0px;
        --btn-scale: 1;
        transform: translate(var(--btn-x), var(--btn-y)) scale(var(--btn-scale));
      }

      .btn.primary {
        background: linear-gradient(135deg, #ff7fb9, #ff9ccd);
        color: #fff;
      }

      .btn.secondary {
        background: linear-gradient(135deg, #ffe4f1, #ffd3e6);
        color: #8f2b57;
      }

      .btn:hover {
        animation: bounce 0.35s ease;
        box-shadow: 0 10px 18px rgba(255, 111, 174, 0.35);
      }

      .btn.wiggle {
        animation: wiggle 0.35s ease;
      }

      .no-btn {
        border: 2px dashed rgba(255, 122, 177, 0.6);
      }

      .kitty-image {
        display: block;
        width: 140px;
        height: 140px;
        object-fit: contain;
        margin: 6px auto 18px;
        background: transparent;
      }

      .float-heart,
      .sparkle,
      .ladybug {
        position: absolute;
        bottom: -10%;
        animation: floatUp 10s linear infinite;
        opacity: 0.8;
        pointer-events: none;
      }

      .sparkle {
        animation: twinkle 3.5s ease-in-out infinite;
        opacity: 0.6;
      }

      .ladybug {
        animation-duration: 12s;
        font-size: 1.3rem;
        opacity: 0.85;
        filter: drop-shadow(0 6px 8px rgba(255, 111, 174, 0.2));
      }

      .minigame-section {
        margin-top: 12px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
      }

      .minigame-section .btn {
        max-width: 420px;
      }

      .modal {
        position: fixed;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 214, 236, 0.75);
        backdrop-filter: blur(6px);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.25s ease;
        z-index: 6;
      }

      .modal.is-open {
        opacity: 1;
        pointer-events: auto;
      }

      .modal-card {
        width: min(92vw, 520px);
        background: linear-gradient(180deg, #fff6fb 0%, #ffeaf6 100%);
        border-radius: 24px;
        padding: 24px;
        border: 2px solid #ffb5d8;
        box-shadow: var(--shadow-soft);
        text-align: center;
      }

      .game-meta {
        display: flex;
        justify-content: space-between;
        font-size: 0.9rem;
        margin: 8px 0 12px;
        color: #8f2b57;
      }

      .game-board {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
        background: #ffd6ea;
        padding: 12px;
        border-radius: 18px;
        box-shadow: inset 0 0 0 2px rgba(255, 141, 194, 0.4);
        margin-bottom: 14px;
        touch-action: none;
      }

      .game-cell {
        position: relative;
        width: 100%;
        padding-top: 100%;
        background: rgba(255, 255, 255, 0.6);
        border-radius: 12px;
      }

      .tile {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 12px;
        font-weight: 800;
        font-size: 1.1rem;
        color: #7a2550;
        box-shadow: inset 0 -4px 0 rgba(255, 111, 174, 0.18);
      }

      .tile[data-value="2"] { background: #fff3f9; }
      .tile[data-value="4"] { background: #ffe7f4; }
      .tile[data-value="8"] { background: #ffd7eb; }
      .tile[data-value="16"] { background: #ffc7e2; }
      .tile[data-value="32"] { background: #ffb6da; }
      .tile[data-value="64"] { background: #ffa3d0; color: #fff; }
      .tile[data-value="128"] { background: #ff8dc6; color: #fff; }
      .tile[data-value="256"] { background: #ff79bc; color: #fff; }
      .tile[data-value="512"] { background: #ff66b3; color: #fff; }
      .tile[data-value="1024"] { background: #ff4ea7; color: #fff; }
      .tile[data-value="2048"] { background: #ff2e97; color: #fff; }

      .btn.ghost {
        background: transparent;
        color: #9a3d6b;
        border: 2px dotted #ffb5d8;
        box-shadow: none;
        margin-top: 10px;
      }

      .celebrate h2 {
        font-size: 1.5rem;
      }

      #burst-layer {
        position: absolute;
        inset: 0;
        pointer-events: none;
      }

      .burst-heart {
        position: absolute;
        left: 50%;
        top: 55%;
        font-size: 1.1rem;
        animation: burst 0.9s ease-out forwards;
        transform: translate(-50%, -50%);
      }

      @keyframes floatUp {
        0% {
          transform: translateY(0) scale(0.9);
          opacity: 0;
        }
        10% {
          opacity: 0.75;
        }
        100% {
          transform: translateY(-140vh) scale(1.3);
          opacity: 0;
        }
      }

      @keyframes twinkle {
        0%,
        100% {
          transform: scale(0.8) rotate(0deg);
          opacity: 0.35;
        }
        50% {
          transform: scale(1.15) rotate(10deg);
          opacity: 0.8;
        }
      }

      @keyframes shimmer {
        0% {
          background-position: 0 0, 10px 12px, 5px 18px;
        }
        100% {
          background-position: 60px -40px, -20px 50px, 40px 80px;
        }
      }

      @keyframes glitterDrift {
        0% {
          background-position: 0 0, 16px 10px, 8px 20px;
        }
        100% {
          background-position: 90px -60px, -40px 70px, 60px 120px;
        }
      }

      @keyframes wiggle {
        0% {
          transform: translate(var(--btn-x), var(--btn-y)) scale(var(--btn-scale)) rotate(0deg);
        }
        30% {
          transform: translate(var(--btn-x), var(--btn-y)) scale(var(--btn-scale)) rotate(-8deg);
        }
        60% {
          transform: translate(var(--btn-x), var(--btn-y)) scale(var(--btn-scale)) rotate(8deg);
        }
        100% {
          transform: translate(var(--btn-x), var(--btn-y)) scale(var(--btn-scale)) rotate(0deg);
        }
      }

      @keyframes bounce {
        0% {
          transform: translate(var(--btn-x), var(--btn-y)) scale(var(--btn-scale));
        }
        50% {
          transform: translate(var(--btn-x), var(--btn-y)) scale(calc(var(--btn-scale) + 0.08));
        }
        100% {
          transform: translate(var(--btn-x), var(--btn-y)) scale(var(--btn-scale));
        }
      }

      @keyframes burst {
        0% {
          transform: translate(-50%, -50%) scale(0.4);
          opacity: 1;
        }
        100% {
          transform: translate(calc(-50% + var(--x)), calc(-50% + var(--y))) scale(1.2);
          opacity: 0;
        }
      }

      @media (max-width: 480px) {
        #app {
          min-height: 480px;
        }

        .card {
          padding: 24px 20px;
        }

        h1 {
          font-size: 1.6rem;
        }

        h2 {
          font-size: 1.35rem;
        }

        .button-row {
          gap: 10px;
        }
      }

      @media (prefers-reduced-motion: reduce) {
        * {
          animation: none !important;
          transition: none !important;
        }
      }
    </style>
  </head>
  <body>
    <main id="app" aria-live="polite">
      <div id="background" aria-hidden="true">
        <div id="float-layer"></div>
        <div id="sparkle-layer"></div>
        <div id="ladybug-layer"></div>
      </div>

      <div id="card-shell">
        <section class="card is-active" data-card="intro" aria-hidden="false">
          <div class="card-title">üíå</div>
          <p>ik i may be a bit slow but i hope this makes up for the last minute call üíï</p>
          <button class="btn primary" data-next="question">Next</button>
        </section>

        <section class="card" data-card="question" aria-hidden="true">
          <div class="card-title">üíñ</div>
          <h1>Will you be my Valentine?</h1>
          <div class="button-row">
            <button class="btn primary" data-yes>Yes üíñ</button>
            <button class="btn secondary no-btn" id="no-btn">No üò¢</button>
          </div>
          <p class="tiny-note">no clicks: <span id="no-count">0</span></p>
        </section>

        <section class="card" data-card="kitty" aria-hidden="true">
          <div class="card-title">üê±üíî</div>
          <p>so you dont like your kitty? üê±üíî</p>
          <img class="kitty-image" src="black-cat.webp" alt="sad black kitty" />
          <div class="button-row">
            <button class="btn primary" data-yes>Yes</button>
            <button class="btn secondary no-btn" id="kitty-no">No</button>
          </div>
        </section>

        <section class="card" data-card="plea" aria-hidden="true">
          <div class="card-title">üòà</div>
          <p>into one ear and out the other üòå i shall consider it as a yes</p>
          <div class="button-row">
            <button class="btn primary" data-yes>Yes</button>
            <button class="btn secondary no-btn" id="plea-no">No</button>
          </div>
          <div class="minigame-section">
            <p class="tiny-note">if ya wanna challenge me then you can</p>
            <button class="btn secondary" id="game-btn">
              Play 2048 to convince me!
            </button>
          </div>
          <p class="tiny-note" id="plea-note">the no button is getting shy...</p>
        </section>

        <section class="card celebrate" data-card="celebrate" aria-hidden="true">
          <div class="card-title">üéÄ</div>
          <h2>THEN YOU SHALL BE MY VALENTINE YAYYY üíñüéÄüêû</h2>
          <p>brace for sparkles, hearts, and tiny ladybug hype</p>
          <div id="burst-layer" aria-hidden="true"></div>
        </section>
      </div>

      <div id="game-modal" class="modal" aria-hidden="true">
        <div class="modal-card">
          <div class="card-title">üéÆüíñ</div>
          <h2>2048 Challenge</h2>
          <p class="tiny-note">use arrow keys or swipe ‚ú®</p>
          <div class="game-meta">
            <span>score: <strong id="game-score">0</strong></span>
            <span id="game-status">keep merging!</span>
          </div>
          <div class="game-board" id="game-board" aria-label="2048 board"></div>
          <div class="button-row">
            <button class="btn secondary" id="game-reset">Reset</button>
            <button class="btn primary" id="game-yes">I'm done (counts as yes)</button>
          </div>
          <button class="btn ghost" id="game-close" aria-label="Close game">Back</button>
        </div>
      </div>
    </main>

    <script>
      const cards = Array.from(document.querySelectorAll(".card"));
      let activeCard = document.querySelector(".card.is-active");

      const noBtn = document.getElementById("no-btn");
      const noCountEl = document.getElementById("no-count");
      const kittyNoBtn = document.getElementById("kitty-no");
      const pleaNoBtn = document.getElementById("plea-no");
      const pleaNote = document.getElementById("plea-note");
      const gameBtn = document.getElementById("game-btn");
      const gameModal = document.getElementById("game-modal");
      const gameBoardEl = document.getElementById("game-board");
      const gameScoreEl = document.getElementById("game-score");
      const gameStatusEl = document.getElementById("game-status");
      const gameResetBtn = document.getElementById("game-reset");
      const gameYesBtn = document.getElementById("game-yes");
      const gameCloseBtn = document.getElementById("game-close");

      let noCount = 0;
      let pleaNoCount = 0;
      let audioCtx = null;
      let gameOpen = false;
      let gameScore = 0;
      let gameBoardState = [];
      let touchStartX = 0;
      let touchStartY = 0;

      const pleaMessages = [
        "the no button is getting shy...",
        "is that a yes in disguise?",
        "pls consider: cute kitty eyes ü•∫",
        "no button is wobbling from confusion",
        "if you press no again, it blushes",
      ];

      function showCard(name) {
        const next = document.querySelector(`.card[data-card="${name}"]`);
        if (!next || next === activeCard) return;
        if (activeCard) {
          activeCard.classList.remove("is-active");
          activeCard.setAttribute("aria-hidden", "true");
        }
        next.classList.add("is-active");
        next.setAttribute("aria-hidden", "false");
        activeCard = next;
        if (name === "celebrate") launchCelebration();
      }

      function playPop() {
        try {
          if (!audioCtx) {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
          }
          if (audioCtx.state === "suspended") audioCtx.resume();
          const osc = audioCtx.createOscillator();
          const gain = audioCtx.createGain();
          osc.type = "triangle";
          osc.frequency.value = 420 + Math.random() * 140;
          gain.gain.setValueAtTime(0.06, audioCtx.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.12);
          osc.connect(gain);
          gain.connect(audioCtx.destination);
          osc.start();
          osc.stop(audioCtx.currentTime + 0.13);
        } catch (err) {
          // Audio is optional; ignore any errors.
        }
      }

      function wiggleButton(btn) {
        btn.classList.remove("wiggle");
        void btn.offsetWidth;
        btn.classList.add("wiggle");
      }

      function resistButton(btn) {
        const x = Math.random() * 50 - 25;
        const y = Math.random() * 28 - 14;
        const scale = 0.92 + Math.random() * 0.08;
        btn.style.setProperty("--btn-x", `${x}px`);
        btn.style.setProperty("--btn-y", `${y}px`);
        btn.style.setProperty("--btn-scale", scale.toFixed(2));
        wiggleButton(btn);
      }

      function openGame() {
        if (!gameModal) return;
        gameModal.classList.add("is-open");
        gameModal.setAttribute("aria-hidden", "false");
        gameOpen = true;
        initGame();
      }

      function closeGame() {
        if (!gameModal) return;
        gameModal.classList.remove("is-open");
        gameModal.setAttribute("aria-hidden", "true");
        gameOpen = false;
      }

      function setGameStatus(text) {
        if (gameStatusEl) gameStatusEl.textContent = text;
      }

      function initGame() {
        gameScore = 0;
        gameBoardState = Array.from({ length: 4 }, () => Array(4).fill(0));
        spawnTile();
        spawnTile();
        setGameStatus("keep merging!");
        renderGame();
      }

      function spawnTile() {
        const empty = [];
        for (let r = 0; r < 4; r += 1) {
          for (let c = 0; c < 4; c += 1) {
            if (gameBoardState[r][c] === 0) empty.push([r, c]);
          }
        }
        if (!empty.length) return;
        const [row, col] = empty[Math.floor(Math.random() * empty.length)];
        gameBoardState[row][col] = Math.random() < 0.9 ? 2 : 4;
      }

      function renderGame() {
        if (!gameBoardEl) return;
        gameBoardEl.innerHTML = "";
        for (let r = 0; r < 4; r += 1) {
          for (let c = 0; c < 4; c += 1) {
            const cell = document.createElement("div");
            cell.className = "game-cell";
            const value = gameBoardState[r][c];
            if (value) {
              const tile = document.createElement("div");
              tile.className = "tile";
              tile.dataset.value = value;
              tile.textContent = value;
              cell.appendChild(tile);
            }
            gameBoardEl.appendChild(cell);
          }
        }
        if (gameScoreEl) gameScoreEl.textContent = gameScore;
        if (hasWon()) {
          setGameStatus("2048!! love unlocked üíñ");
        } else if (!hasMoves()) {
          setGameStatus("no moves left (still counts as yes)");
        }
      }

      function collapseRow(row) {
        const filtered = row.filter((value) => value !== 0);
        const merged = [];
        for (let i = 0; i < filtered.length; i += 1) {
          if (filtered[i] === filtered[i + 1]) {
            const val = filtered[i] * 2;
            merged.push(val);
            gameScore += val;
            i += 1;
          } else {
            merged.push(filtered[i]);
          }
        }
        while (merged.length < 4) merged.push(0);
        return merged;
      }

      function move(direction) {
        let moved = false;
        if (direction === "left" || direction === "right") {
          for (let r = 0; r < 4; r += 1) {
            const row = [...gameBoardState[r]];
            const working = direction === "right" ? row.reverse() : row;
            const collapsed = collapseRow(working);
            const newRow = direction === "right" ? collapsed.reverse() : collapsed;
            if (newRow.some((value, idx) => value !== gameBoardState[r][idx])) {
              moved = true;
              gameBoardState[r] = newRow;
            }
          }
        } else {
          for (let c = 0; c < 4; c += 1) {
            const column = [];
            for (let r = 0; r < 4; r += 1) column.push(gameBoardState[r][c]);
            const working = direction === "down" ? column.reverse() : column;
            const collapsed = collapseRow(working);
            const newCol = direction === "down" ? collapsed.reverse() : collapsed;
            for (let r = 0; r < 4; r += 1) {
              if (gameBoardState[r][c] !== newCol[r]) moved = true;
              gameBoardState[r][c] = newCol[r];
            }
          }
        }

        if (moved) {
          spawnTile();
          renderGame();
        }
      }

      function hasMoves() {
        for (let r = 0; r < 4; r += 1) {
          for (let c = 0; c < 4; c += 1) {
            if (gameBoardState[r][c] === 0) return true;
            if (r < 3 && gameBoardState[r][c] === gameBoardState[r + 1][c]) return true;
            if (c < 3 && gameBoardState[r][c] === gameBoardState[r][c + 1]) return true;
          }
        }
        return false;
      }

      function hasWon() {
        return gameBoardState.some((row) => row.some((value) => value >= 2048));
      }

      function handleMove(direction) {
        if (!gameOpen) return;
        move(direction);
      }

      function launchCelebration() {
        const burstLayer = document.getElementById("burst-layer");
        burstLayer.innerHTML = "";
        for (let i = 0; i < 28; i += 1) {
          const heart = document.createElement("span");
          heart.className = "burst-heart";
          heart.textContent = ["üíñ", "üíó", "üíï", "üíû"][i % 4];
          const x = Math.random() * 220 - 110;
          const y = Math.random() * 220 - 150;
          heart.style.setProperty("--x", `${x}px`);
          heart.style.setProperty("--y", `${y}px`);
          heart.style.fontSize = `${14 + Math.random() * 14}px`;
          burstLayer.appendChild(heart);
        }
      }

      document.querySelectorAll("[data-next]").forEach((btn) => {
        btn.addEventListener("click", () => {
          playPop();
          showCard(btn.dataset.next);
        });
      });

      document.querySelectorAll("[data-yes]").forEach((btn) => {
        btn.addEventListener("click", () => {
          playPop();
          showCard("celebrate");
        });
      });

      if (gameBtn) {
        gameBtn.addEventListener("click", () => {
          playPop();
          openGame();
        });
      }

      if (gameResetBtn) {
        gameResetBtn.addEventListener("click", () => {
          playPop();
          initGame();
        });
      }

      if (gameYesBtn) {
        gameYesBtn.addEventListener("click", () => {
          playPop();
          closeGame();
          showCard("celebrate");
        });
      }

      if (gameCloseBtn) {
        gameCloseBtn.addEventListener("click", () => {
          playPop();
          closeGame();
        });
      }

      if (gameModal) {
        gameModal.addEventListener("click", (event) => {
          if (event.target === gameModal) closeGame();
        });
      }

      if (noBtn) {
        noBtn.addEventListener("click", () => {
          playPop();
          noCount += 1;
          noCountEl.textContent = noCount;
          resistButton(noBtn);
          if (noCount >= 15) showCard("kitty");
        });
      }

      if (kittyNoBtn) {
        kittyNoBtn.addEventListener("click", () => {
          playPop();
          resistButton(kittyNoBtn);
          showCard("plea");
        });
      }

      if (pleaNoBtn) {
        pleaNoBtn.addEventListener("click", () => {
          playPop();
          pleaNoCount += 1;
          resistButton(pleaNoBtn);
          const msg = pleaMessages[pleaNoCount % pleaMessages.length];
          pleaNote.textContent = msg;
        });
      }

      window.addEventListener("keydown", (event) => {
        if (!gameOpen) return;
        const keys = {
          ArrowLeft: "left",
          ArrowRight: "right",
          ArrowUp: "up",
          ArrowDown: "down",
        };
        if (keys[event.key]) {
          event.preventDefault();
          handleMove(keys[event.key]);
        }
      });

      if (gameBoardEl) {
        gameBoardEl.addEventListener("touchstart", (event) => {
          if (!gameOpen) return;
          const touch = event.changedTouches[0];
          touchStartX = touch.clientX;
          touchStartY = touch.clientY;
        });

        gameBoardEl.addEventListener("touchend", (event) => {
          if (!gameOpen) return;
          const touch = event.changedTouches[0];
          const dx = touch.clientX - touchStartX;
          const dy = touch.clientY - touchStartY;
          if (Math.max(Math.abs(dx), Math.abs(dy)) < 24) return;
          if (Math.abs(dx) > Math.abs(dy)) {
            handleMove(dx > 0 ? "right" : "left");
          } else {
            handleMove(dy > 0 ? "down" : "up");
          }
        });
      }

      function spawnFloaters() {
        const floatLayer = document.getElementById("float-layer");
        const sparkleLayer = document.getElementById("sparkle-layer");
        const ladybugLayer = document.getElementById("ladybug-layer");
        const hearts = ["‚ù§", "üíó", "üíñ", "üíï", "üíû", "üíò"];
        const sparkles = ["‚ú®", "‚ú¶", "‚úß", "‚ú∫"];

        for (let i = 0; i < 24; i += 1) {
          const heart = document.createElement("span");
          heart.className = "float-heart";
          heart.textContent = hearts[i % hearts.length];
          heart.style.left = `${Math.random() * 100}%`;
          heart.style.fontSize = `${12 + Math.random() * 16}px`;
          heart.style.animationDuration = `${8 + Math.random() * 6}s`;
          heart.style.animationDelay = `${-Math.random() * 8}s`;
          heart.style.opacity = `${0.4 + Math.random() * 0.5}`;
          floatLayer.appendChild(heart);
        }

        for (let i = 0; i < 28; i += 1) {
          const sparkle = document.createElement("span");
          sparkle.className = "sparkle";
          sparkle.textContent = sparkles[i % sparkles.length];
          sparkle.style.left = `${Math.random() * 100}%`;
          sparkle.style.top = `${Math.random() * 100}%`;
          sparkle.style.fontSize = `${9 + Math.random() * 12}px`;
          sparkle.style.animationDelay = `${-Math.random() * 4}s`;
          sparkle.style.animationDuration = `${2.8 + Math.random() * 3.2}s`;
          sparkle.style.opacity = `${0.35 + Math.random() * 0.5}`;
          sparkleLayer.appendChild(sparkle);
        }

        for (let i = 0; i < 6; i += 1) {
          const bug = document.createElement("span");
          bug.className = "ladybug";
          bug.textContent = "üêû";
          bug.style.left = `${Math.random() * 100}%`;
          bug.style.fontSize = `${16 + Math.random() * 8}px`;
          bug.style.animationDuration = `${10 + Math.random() * 6}s`;
          bug.style.animationDelay = `${-Math.random() * 6}s`;
          ladybugLayer.appendChild(bug);
        }
      }

      spawnFloaters();
    </script>
  </body>
</html>
